<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Memory Game - Super Version</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    background: #f0f8ff;
    overflow: hidden;
  }
  h1 { margin-top: 20px; color: #333; }
  .timer { font-size: 20px; margin-top: 10px; color: #333; }
  .game-board { display: grid; gap: 10px; justify-content: center; margin-top: 20px; }
  .card {
    width: 80px; height: 80px; background-color: #ccc; border-radius: 10px;
    display: flex; justify-content: center; align-items: center;
    cursor: pointer; font-size: 40px;
    transition: background-color 0.3s, transform 0.2s;
  }
  .card.flipped { background-color: #fff; cursor: default; }
  .message { margin-top: 30px; font-size: 24px; color: #2e8b57; animation: bounceIn 1s ease forwards; display: none; }
  .message.fail { color: #d9534f; }
  .controls { margin-top: 20px; }
  button { padding: 8px 18px; font-size: 16px; margin: 5px; cursor: pointer; }
  .sprinkle { position: absolute; width: 10px; height: 10px; background: rgba(255,255,255,0.7); border-radius: 50%; animation: fall 5s linear infinite; }
  @keyframes fall {0% { transform: translateY(-10px) translateX(0); opacity:1; }100% { transform: translateY(800px) translateX(50px); opacity:0; }}
  @keyframes bounceIn {0% { transform: scale(0.5); opacity: 0; }60% { transform: scale(1.2); opacity: 1; }100% { transform: scale(1); }}
</style>
</head>
<body>
<h1>ğŸƒ Memory Game - Super Version</h1>

<div class="controls">
  <label for="playerName">Enter your name: </label>
  <input type="text" id="playerName" placeholder="Player Name" />
  <select id="levelSelect">
    <option value="easy">Easy (4x2, 15s)</option>
    <option value="medium">Medium (4x4, 30s)</option>
    <option value="hard">Hard (6x6, 80s)</option>
  </select>
  <button id="startBtn">Start Game</button>
  <button id="muteBtn">ğŸ”Š Mute</button>
</div>

<div class="timer" id="timer">â± Time left: 0s</div>
<div class="game-board" id="gameBoard"></div>
<div class="message" id="message"></div>
<button id="playAgainBtn" style="display:none;">Play Again</button>
<div class="leaderboard" id="leaderboard"></div>

<audio id="bgMusic" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" loop></audio>
<audio id="flipSound" src="https://freesound.org/data/previews/176/176522_3247663-lq.mp3"></audio>
<audio id="matchSound" src="https://freesound.org/data/previews/256/256113_4486188-lq.mp3"></audio>
<audio id="tickSound" src="https://freesound.org/data/previews/256/256117_4486188-lq.mp3"></audio>

<script>
const symbols = ['ğŸ’','ğŸ”·','ğŸ”¶','ğŸ”º','ğŸ”µ','ğŸ”¸','ğŸ’ ','ğŸ”»','â­','ğŸŒŸ','ğŸ€','ğŸ','ğŸµ','ğŸˆ','âš¡','ğŸ”¥','ğŸŒˆ','ğŸª','ğŸ','ğŸ©'];
let cards = [];
const gameBoard = document.getElementById('gameBoard');
const message = document.getElementById('message');
const timerDisplay = document.getElementById('timer');
const startBtn = document.getElementById('startBtn');
const playAgainBtn = document.getElementById('playAgainBtn');
const muteBtn = document.getElementById('muteBtn');
const bgMusic = document.getElementById('bgMusic');
const flipSound = document.getElementById('flipSound');
const matchSound = document.getElementById('matchSound');
const tickSound = document.getElementById('tickSound');
const playerNameInput = document.getElementById('playerName');
const leaderboardDiv = document.getElementById('leaderboard');
const levelSelect = document.getElementById('levelSelect');

let flippedCards = [], matchedCount = 0, lockBoard = false, timeLeft = 0, timerInterval = null, gameOver = false, playerName = "", gridCols = 4, gridRows = 2;

function createSprinkles(count=50){
  for(let i=0;i<count;i++){
    const sprinkle = document.createElement('div');
    sprinkle.className='sprinkle';
    sprinkle.style.left=Math.random()*window.innerWidth+'px';
    sprinkle.style.animationDuration=(3+Math.random()*3)+'s';
    sprinkle.style.width=sprinkle.style.height=(5+Math.random()*5)+'px';
    document.body.appendChild(sprinkle);
  }
}

function startGame(){
  playerName = playerNameInput.value.trim();
  if(!playerName){ alert("Enter your name!"); return; }
  bgMusic.play();
  startBtn.disabled=true; playerNameInput.disabled=true;
  const level = levelSelect.value;
  if(level==='easy'){ gridCols=4; gridRows=2; timeLeft=15; }
  else if(level==='medium'){ gridCols=4; gridRows=4; timeLeft=30; }
  else{ gridCols=6; gridRows=6; timeLeft=80; }

  const neededCards = Math.floor((gridCols*gridRows)/2);
  cards = [...symbols.slice(0,neededCards), ...symbols.slice(0,neededCards)];
  cards.sort(()=>0.5-Math.random());

  gameBoard.innerHTML='';
  gameBoard.style.gridTemplateColumns=`repeat(${gridCols}, 80px)`;
  cards.forEach((symbol,index)=>{
    const card=document.createElement('div');
    card.classList.add('card');
    card.dataset.symbol=symbol;
    card.dataset.index=index;
    card.addEventListener('click',()=>flipCard(card));
    gameBoard.appendChild(card);
  });

  flippedCards=[]; matchedCount=0; lockBoard=false; gameOver=false;
  timerDisplay.textContent=`â± Time left: ${timeLeft}s`;
  message.style.display='none'; playAgainBtn.style.display='none';
  startTimer();
  showLeaderboard();
}

function startTimer(){
  if(timerInterval) clearInterval(timerInterval);
  timerInterval=setInterval(()=>{
    timeLeft--;
    timerDisplay.textContent=`â± Time left: ${timeLeft}s`;
    if(timeLeft<=10 && !gameOver){ tickSound.play(); }
    if(timeLeft<=0){ clearInterval(timerInterval); endGame(false); }
  },1000);
}

function flipCard(card){
  if(lockBoard || card.classList.contains('flipped') || gameOver) return;
  card.classList.add('flipped'); card.textContent=card.dataset.symbol; flippedCards.push(card);
  flipSound.play();
  if(flippedCards.length===2){ checkForMatch(); }
}

function checkForMatch(){
  const [c1,c2]=flippedCards;
  if(c1.dataset.symbol===c2.dataset.symbol){
    matchedCount++; flippedCards=[]; matchSound.play();
    if(matchedCount===cards.length/2){ clearInterval(timerInterval); endGame(true); }
  } else{
    lockBoard=true;
    setTimeout(()=>{
      c1.classList.remove('flipped'); c2.classList.remove('flipped'); c1.textContent=''; c2.textContent=''; flippedCards=[]; lockBoard=false;
    },800);
  }
}

function endGame(won){
  gameOver=true; lockBoard=true; message.style.display='block';
  message.classList.toggle('fail',!won);
  message.innerHTML=won?`ğŸ‰ ${playerName}, You completed the game! ğŸ‰`:`â° Time's up, ${playerName}!`;

  // Reveal all cards if time is over
  if(!won){
    const allCards=document.querySelectorAll('.card');
    allCards.forEach(card=>{
      card.classList.add('flipped');
      card.textContent=card.dataset.symbol;
    });
  }

  if(won){
    for(let i=0;i<150;i++){
      const conf=document.createElement('div');
      conf.textContent='ğŸ‰'; conf.style.position='absolute';
      conf.style.left=Math.random()*window.innerWidth+'px';
      conf.style.top=Math.random()*window.innerHeight+'px';
      conf.style.fontSize=(10+Math.random()*20)+'px';
      document.body.appendChild(conf);
      setTimeout(()=>conf.remove(),3000);
    }
    const bestTime = localStorage.getItem(`memory_bestTime_${playerName}`);
    const timeTaken = (levelSelect.value==='easy'?15:levelSelect.value==='medium'?30:80)-timeLeft;
    if(!bestTime || timeTaken<bestTime) localStorage.setItem(`memory_bestTime_${playerName}`,timeTaken);
  }

  playAgainBtn.style.display='inline-block';
  showLeaderboard();
}

function showLeaderboard(){
  const keys=Object.keys(localStorage).filter(k=>k.startsWith('memory_bestTime_'));
  if(keys.length===0){ leaderboardDiv.innerHTML='ğŸ† Leaderboard empty'; return; }
  const list=keys.map(k=>({name:k.replace('memory_bestTime_',''),time:localStorage.getItem(k)}));
  list.sort((a,b)=>a.time-b.time);
  leaderboardDiv.innerHTML='<h3>ğŸ† Leaderboard</h3><ol>'+list.map(e=>`<li>${e.name}: ${e.time}s</li>`).join('')+'</ol>';
}

startBtn.addEventListener('click',startGame);
playAgainBtn.addEventListener('click',()=>{
  playerNameInput.disabled=false; playerNameInput.value=''; startBtn.disabled=false;
  gameBoard.innerHTML=''; message.style.display='none'; playAgainBtn.style.display='none';
  timerDisplay.textContent="â± Time left: 0s"; bgMusic.pause(); bgMusic.currentTime=0;
  flippedCards=[]; matchedCount=0; lockBoard=false; gameOver=false;
});
muteBtn.addEventListener('click',()=>{
  if(bgMusic.paused){ bgMusic.play(); muteBtn.textContent='ğŸ”Š Mute'; }
  else{ bgMusic.pause(); muteBtn.textContent='ğŸ”‡ Unmute'; }
});

window.onload=createSprinkles;
</script>
</body>
</html>
